{"version":3,"sources":["Login.js","TrackSearchResult.js","Player.js","vidBackground.mp4","Dashboard.js","useAuth.js","App.js","index.js"],"names":["buildScope","join","AUTH_URL","Login","Container","className","style","minHeight","href","TrackSearchResults","track","chooseTrack","cursor","onClick","src","albumUrl","alt","height","width","title","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","catch","err","console","log","error","interval","setInterval","window","history","pushState","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","autoPlay","loop","muted","position","left","top","objectFit","transform","zIndex","videoContent","type","Form","Control","placeholder","value","onChange","e","target","overflow","length","whiteSpace","backgroundColor","opacity","fontsize","fontWeight","App","URLSearchParams","location","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8461c8a9.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Container } from \"react-bootstrap\";\r\n// import redirect_uri from \"./config/\"\r\n\r\nconst client_id = \"11811ab54cf1454bbfa5075f5ed86dba\";\r\nconst response_type = \"code\";\r\nconst redirect_uri = \r\n    \"http://localhost:3000\" || \"https://monde-green.herokuapp.com\";\r\nconst scope = [\r\n    \"streaming\",\r\n    \"user-read-email\",\r\n    \"user-read-private\",\r\n    \"user-library-read\",\r\n    \"user-library-modify\",\r\n    \"user-read-playback-state\",\r\n    \"user-modify-playback-state\",\r\n];\r\nconst webspace = \"%20\";\r\n\r\n// could use encodeURI(uri);\r\nconst buildScope = scope.join(webspace);\r\n\r\nconst AUTH_URL = `https://accounts.spotify.com/authorize?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&scope=${buildScope}`;\r\n\r\nexport default function Login() {\r\n    return (\r\n        <Container\r\n            className=\"d-flex justify-content-center align-items-center\"\r\n            style={{ minHeight: \"100vh\" }}\r\n        >\r\n            <a className=\"btn btn-success bt-lg\" href={AUTH_URL}>\r\n                Login to Spotify\r\n            </a>\r\n        </Container>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nexport default function TrackSearchResults({ track, chooseTrack }) {\r\n    return (\r\n        <div className=\"d-flex m-2 align-items-center\" style={{ cursor: \"pointer\"}} onClick={function handlePlay() {\r\n            chooseTrack(track)\r\n        }}>\r\n            <img\r\n                src={track.albumUrl}\r\n                alt=\"album art\"\r\n                style={{ height: \"64px\", width: \"64px\" }}\r\n            />\r\n            <div className=\"ml-3\">\r\n                <div>{track.title}</div>\r\n                <div className=\"text-muted\">{track.artist}</div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport SpotifyPlayer from \"react-spotify-web-playback\";\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n    const [play, setPlay] = useState(false);\r\n\r\n    useEffect(() => setPlay(true), [trackUri]);\r\n\r\n    if (!accessToken) return null;\r\n    return (\r\n        <SpotifyPlayer\r\n            token={accessToken}\r\n            showSaveIcon\r\n            callback={state => {\r\n                if (!state.isPlaying) setPlay(false);\r\n            }}\r\n            play={play}\r\n            uris={trackUri ? [trackUri] : []}\r\n        />\r\n    );\r\n}\r\n","export default __webpack_public_path__ + \"static/media/vidBackground.134c4759.mp4\";","import { useState, useEffect } from \"react\";\r\nimport useAuth from \"./useAuth\";\r\nimport TrackSearchResult from \"./TrackSearchResult\";\r\nimport Player from \"./Player\";\r\nimport videoContent from \"./vidBackground.mp4\";\r\nimport { Container, Form } from \"react-bootstrap\";\r\nimport SpotifyWebApi from \"spotify-web-api-node\";\r\nimport axios from \"axios\";\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n    clientId: \"11811ab54cf1454bbfa5075f5ed86dba\",\r\n});\r\n\r\nexport default function Dashboard({ code }) {\r\n    const accessToken = useAuth(code);\r\n    const [search, setSearch] = useState(\"\");\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const [playingTrack, setPlayingTrack] = useState();\r\n    const [lyrics, setLyrics] = useState(\"\");\r\n\r\n\r\n    function chooseTrack(track) {\r\n        setPlayingTrack(track);\r\n        setSearch(\"\");\r\n        setLyrics(\"\");\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!playingTrack) return;\r\n\r\n        axios\r\n            .get(\"/lyrics\", {\r\n                params: {\r\n                    track: playingTrack.title,\r\n                    artist: playingTrack.artist,\r\n                },\r\n            })\r\n            .then((res) => {\r\n                setLyrics(res.data.lyrics);\r\n            });\r\n    }, [playingTrack]);\r\n\r\n    // help with search:\r\n    useEffect(() => {\r\n        if (!accessToken) return;\r\n        spotifyApi.setAccessToken(accessToken);\r\n    }, [accessToken]);\r\n\r\n    // help with search & if accessToken changes:\r\n    useEffect(() => {\r\n        if (!search) return setSearchResults([]);\r\n        if (!accessToken) return;\r\n\r\n        let cancel = false;\r\n\r\n        spotifyApi.searchTracks(search).then((res) => {\r\n            if (cancel) return;\r\n            setSearchResults(\r\n                res.body.tracks.items.map((track) => {\r\n                    // look thru to determine smallest image:\r\n                    const smallestAlbumImage = track.album.images.reduce(\r\n                        (smallest, image) => {\r\n                            if (image.height < smallest.height) return image;\r\n                            return smallest;\r\n                        },\r\n                        track.album.images[0]\r\n                    );\r\n\r\n                    return {\r\n                        artist: track.artists[0].name,\r\n                        title: track.name,\r\n                        uri: track.uri,\r\n                        albumUrl: smallestAlbumImage.url,\r\n                    };\r\n                })\r\n            );\r\n        });\r\n\r\n        return () => (cancel = true);\r\n    }, [search, accessToken]);\r\n\r\n    return (\r\n        <Container\r\n            className=\"d-flex flex-column py-2\"\r\n            style={{ height: \"100vh\" }}\r\n        >\r\n            <video\r\n                className=\"bg-fullscreen\"\r\n                autoPlay\r\n                loop\r\n                muted\r\n                style={{\r\n                    position: \"absolute\",\r\n                    width: \"100%\",\r\n                    height: \"100%\",\r\n                    left: \"50%\",\r\n                    top: \"50%\",\r\n                    objectFit: \"cover\",\r\n                    transform: \"translate(-50%, -50%\",\r\n                    zIndex: \"-1\"\r\n                }}\r\n            >\r\n                <source src={videoContent} type=\"video/mp4\" />\r\n            </video>\r\n\r\n            <Form.Control\r\n                type=\"search\"\r\n                placeholder=\"Search songs/Artists\"\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n            />\r\n            <div className=\"flex-grow-1 my-2\" style={{ overflow: \"auto\" }}>\r\n                {searchResults.map((track) => {\r\n                    return (\r\n                        <TrackSearchResult\r\n                            track={track}\r\n                            key={track.uri}\r\n                            chooseTrack={chooseTrack}\r\n                        />\r\n                    );\r\n                })}\r\n                {searchResults.length === 0 && (\r\n                    <div\r\n                        className=\"text-center\"\r\n                        style={{\r\n                            whiteSpace: \"pre\",\r\n                            backgroundColor: \"whitesmoke\",\r\n                            opacity: \".7\",\r\n                            fontsize: \"18px\",\r\n                            fontWeight: \"bold\"\r\n                        }}\r\n                    >\r\n                        {lyrics}\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <div>\r\n                <Player\r\n                    accessToken={accessToken}\r\n                    trackUri={playingTrack?.uri}\r\n                />\r\n            </div>\r\n        </Container>\r\n    );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function useAuth(code) {\r\n    const [accessToken, setAccessToken] = useState(null);\r\n    const [refreshToken, setRefreshToken] = useState(null);\r\n    const [expiresIn, setExpiresIn] = useState(null);\r\n\r\n    useEffect(() => {\r\n        return axios\r\n            .post(\"/login\", {\r\n                code,\r\n            })\r\n            .then((res) => {\r\n                setAccessToken(res.data.accessToken);\r\n                setRefreshToken(res.data.refreshToken);\r\n                setExpiresIn(res.data.expiresIn);\r\n\r\n                // Set the access token on the API object to use it in later calls\r\n\r\n                // window.history.pushState({}, null, \"/\");\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"======================================\");\r\n                console.error(err);\r\n                // window.location = \"/\";\r\n            });\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [code]);\r\n\r\n    // whenever token expires, refresh:\r\n    useEffect(() => {\r\n        if (refreshToken === null || expiresIn === null) {\r\n            return;\r\n        } else {\r\n            const interval = setInterval(() => {\r\n\r\n                axios\r\n                    .post(\"/refresh\", {\r\n                        refreshToken,\r\n                    })\r\n                    .then((res) => {\r\n\r\n                        // Set the access token on the API object to use it in later calls\r\n                        setAccessToken(res.data.accessToken);\r\n                        setExpiresIn(res.data.expiresIn);\r\n\r\n                        window.history.pushState({}, null, \"/\");\r\n                    })\r\n                    .catch((err) => {\r\n                        console.error(err);\r\n                        // window.location = \"/\";\r\n                    });\r\n            }, (expiresIn - 60) * 1000);\r\n            return () => clearInterval(interval);\r\n        }\r\n    }, [refreshToken, expiresIn]);\r\n\r\n    return accessToken;\r\n}\r\n","import \"bootstrap/dist/css/bootstrap.css\";\nimport Login from \"./Login\";\nimport Dashboard from \"./Dashboard\";\n\nfunction App() {\n\n    const code = new URLSearchParams(window.location.search).get(\"code\");\n\n    return code ? <Dashboard code={code} /> : <Login />;\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}